<!DOCTYPE html>

<html lang="ja">

<head>

<meta charset="utf-8">

<title>マイゲーム</title>

<!-- ★ iOS や Android 用 -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="viewport" content="width=400, user-scalable=no">

<!-- ★ Windows 用 -->
<style>
@-ms-viewport { width:400px;}
body { -ms-content-zooming:none;}
</style>

</head>

<body style="
	background-color: #cccccc;
	font-family: 'Rounded Mplus 1c', sans-serif;
	font-size: 30px;
	font-weight: 500;
	color: #000000;
	line-height: 1.2;
">

<br><br>

<center>
<canvas style="width:400px; height:600px;" id="c1"></canvas><br>
</center>
<br>

Excuse me<br>

<script src="skeleton_touch.js"></script>

<script>

var skt;

var can, ctx; //変数を宣言する。

can = document.getElementById("c1");
can.width = 400;
can.height = 600;
ctx = can.getContext("2d");

var MAXTOUCH = 5;
var CAN_PINCH = false;
var REFW = 400, REFH = 300;

skt = new skeleton_touch( can);
skt.set_mag_and_orientation( 1, 0);

//●●●●●●●●●●


var img_cow,img_coin;
var bx, by, bvx, bvy;
var rx;
var sc;

sc=0;

img_cow = new Image();
img_cow.src = "cow.jpg"
bx = 200;
by = 50;
bvx = 8;
bvy = 3;

rx = 200;

img_coin = new Image();
img_coin.src = "coin.jpg"
px = 50;
py = 50;

var count;

count = 0;
tic();

function tic(){
	var i;

	requestAnimationFrame( tic);

	skt.pre();

	ctx.fillStyle="#ffffff";
	ctx.fillRect( 0, 0, 400, 600);

	ctx.fillStyle="#00ff00";
	ctx.fillRect( 0, 500, 400, 100);

	ctx.fillStyle="#ffff00";
	for( i = 0; i < 10; i++){
		ctx.fillRect( 10 + i * 40, 540-( i%2)*20, 20, 20);
	}

	//ctx.drawImage( img_cow, bx, by, 100, 100);
	db(bx,by);

	ctx.drawImage( img_coin, px, py, 50, 50);

	ctx.fillStyle="#00ffff";
	ctx.fillRect( rx-50, 450, 100, 10);

	if( skt.start){
		if( skt.x < rx){
			rx -= 30;
			if(rx<0) rx=0;
		} else{
			rx += 30;
			if(rx>400)rx=400;
		}
	}

	bx = bx + bvx;
	if(bx>400){
		bx=400;
		bvx=-bvx;
	}
	if(bx<0){
		bx=0;
		bvx=-bvx;
	}
	by = by + bvy;
	if(by>445 &&by<455){
		if(bx>rx-50 &&bx<rx+50 ){
			by=445;
			bvy=-bvy;
			if( bx - rx < -30) bvx=-10;
			else if( bx - rx < -10) bvx=-5;
			else if( bx - rx < 10) bvx=0;
			else if( bx - rx < 30) bvx=5;
			else bvx=10;
		}
	}
	if(by<0){
		by=0;
		bvy=-bvy;
	}

	ctx.fillStyle="#ff0000";
	ctx.font="30px 'Arial";
	ctx.fillText( "score " + sc, 10, 590);

	skt.post();

	count++;
}

function db( x, y){
	ctx.drawImage( img_cow, x-25, y-25, 50, 50);
}

</script>


</body>

</html>
